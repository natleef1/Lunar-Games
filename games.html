<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <title>Lunar</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="/media/logo.svg">
</head>
<body>
    <nav>
        <ul style="text-align: left;"><b>
            <li><a href="index.html"><i data-lucide="moon-star" class="navlogo"></i></a></li>
        </ul>
        <ul style="text-align: right;" class="tabs">
            <li><a href="games.html"><i data-lucide="gamepad" class="navitem"></i>Games</a></li>
            <li><a href="apps.html"><i data-lucide="layout-grid" class="navitem"></i>Apps</a></li>
            <li style="margin-right: 40px;"><a href="settings.html"><i data-lucide="settings-2" class="navitem"></i>Settings</a></li>
        </b></ul>
    </nav>
    <main>
    <h1 class="title2">Games</h1>
    <div class="search-container">
        <input id="gameSearch" class="search-input" type="search" placeholder="Search games..." aria-label="Search games">
    </div>
    <div class="game2" id="gamesList">
        <noscript>
            <p>Enable JavaScript to see the games list.</p>
        </noscript>
    </div>

    </main>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script>
    lucide.createIcons();
    let allGames = [];

    async function loadGames(){
        try{
            const res = await fetch('games.json');
            if(!res.ok) throw new Error('Could not load games.json');
            const games = await res.json();
            // sort alphabetically by name (case-insensitive)
            games.sort((a,b)=> (a.name||'').localeCompare(b.name||'', undefined, {sensitivity: 'base'}));
            allGames = games;
            renderGames(allGames);
        }catch(e){
            console.error(e);
        }
    }

    function renderGames(list){
        const container = document.getElementById('gamesList');
        container.innerHTML = '';
        if(!list || list.length === 0){
            const p = document.createElement('p');
            p.textContent = 'No games found.';
            p.style.color = '#cdd6f4';
            container.appendChild(p);
            return;
        }
        list.forEach(g=>{
            const game = document.createElement('div');
            game.className = 'game';

            const a = document.createElement('a');
            a.href = g.url || '#';
            a.target = '_blank';
            a.rel = 'noopener noreferrer';

            const img = document.createElement('img');
            img.className = 'game-img';
            img.src = g.icon || '/media/logo.svg';
            img.alt = g.name || 'game';

            const h = document.createElement('h1');
            h.className = 'game-txt';
            const u = document.createElement('u');
            u.textContent = g.name || 'Untitled';
            h.appendChild(u);

            a.appendChild(img);
            a.appendChild(h);
            game.appendChild(a);
            container.appendChild(game);
        });
        lucide.createIcons();
    }

    document.addEventListener('DOMContentLoaded', () => {
        loadGames();
        const search = document.getElementById('gameSearch');
        if(search){
            search.addEventListener('input', (e) => {
                const q = (e.target.value || '').trim().toLowerCase();
                if(!q) return renderGames(allGames);
                const filtered = allGames.filter(g=> (g.name||'').toLowerCase().includes(q));
                renderGames(filtered);
            });
        }
    });
    </script>
</body>
</html>
